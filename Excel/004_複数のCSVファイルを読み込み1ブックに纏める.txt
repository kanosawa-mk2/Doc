Sub ImportCSVFiles()
    Dim ws As Worksheet
    Dim fso As Object
    Dim folderPath As String
    Dim fileName As String
    Dim filePath As String
    Dim textLine As String
    Dim rowNum As Long, colNum As Long
    Dim cellValues As Variant
    Dim tempStr As String
    Dim cellValue As String
    Dim inQuotes As Boolean
    Dim i As Integer
    
    ' CSVフォルダのパスを指定（適宜変更）
    folderPath = "C:\CSVフォルダ\"
    
    ' FileSystemObject を作成
    Set fso = CreateObject("Scripting.FileSystemObject")
    
    ' フォルダ内のCSVファイルを検索
    fileName = Dir(folderPath & "*.csv")
    
    ' CSVファイルを1つずつ処理
    Do While fileName <> ""
        filePath = folderPath & fileName
        
        ' 新しいシートを作成
        Set ws = ThisWorkbook.Sheets.Add
        ws.Name = Left(fileName, Len(fileName) - 4) ' 拡張子を除く
        
        ' ファイルを開く（UTF-8対応）
        Dim fileNum As Integer
        fileNum = FreeFile
        Open filePath For Input As #fileNum
        
        rowNum = 1
        
        ' ファイルの内容を1行ずつ処理
        Do While Not EOF(fileNum)
            Line Input #fileNum, textLine ' 1行読み込み
            
            ' ダブルクォーテーション内のカンマを考慮したパース
            cellValues = SplitCSV(textLine)
            
            colNum = 1
            For i = LBound(cellValues) To UBound(cellValues)
                ' **Excelの自動変換を防ぐ**
                ws.Cells(rowNum, colNum).Value = "'" & cellValues(i)
                colNum = colNum + 1
            Next i
            
            rowNum = rowNum + 1
        Loop
        
        ' ファイルを閉じる
        Close #fileNum
        
        ' 次のファイルへ
        fileName = Dir()
    Loop
    
    MsgBox "CSVの読み込みが完了しました！", vbInformation
End Sub
